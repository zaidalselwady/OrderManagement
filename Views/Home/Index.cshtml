@model Order_Management_System.Models.ViewModels.DashboardViewModel
@{
    ViewData["Title"] = "Orders Management Dashboard";
}

<!-- External Resources -->
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="page-wrapper">
    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content full-width">
            <h2 class="header-title animate__animated animate__fadeIn">Orders Management System</h2>
            <nav class="header-nav">
                <a href="#" class="nav-link animate__animated animate__fadeIn" style="animation-delay: 0.1s">Home</a>
                <a href="#" class="nav-link animate__animated animate__fadeIn" style="animation-delay: 0.2s">Reports</a>
                <a href="#" class="nav-link animate__animated animate__fadeIn" style="animation-delay: 0.3s">Settings</a>
                <button id="theme-toggle" class="theme-toggle animate__animated animate__fadeIn" style="animation-delay: 0.4s" aria-label="Toggle theme">🌙</button>
                <div class="user-profile animate__animated animate__fadeIn" style="animation-delay: 0.5s">
                    <div class="welcome-message">
                        <h2>Welcome, @Model.UserName</h2>
                    </div>
                    <a href="#" class="logout-link" aria-label="Logout" onclick="confirmLogout(event)">Logout</a>
                </div>
            </nav>
        </div>
    </header>

    <div class="container full-width">
        <!-- Summary Statistics -->
        <div class="summary-stats full-width animate__animated animate__fadeIn" style="animation-delay: 0.2s">
            <div class="stat-card">
                <h3>Total Orders</h3>
                <p id="total-orders">@Model.TotalOrders</p>
            </div>
            <div class="stat-card">
                <h3>Total Amount</h3>
                <p id="total-amount">@Model.TotalAmount.ToString("C")</p>
            </div>
            <div class="stat-card">
                <h3>Recent Orders (Last 7 Days)</h3>
                <p id="recent-orders">@Model.RecentOrders</p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons full-width animate__animated animate__slideUp" style="animation-delay: 0.3s">
            <a href="@Url.Action("Add", "Order")" class="btn btn-primary btn-lg">
                <i class="fas fa-plus"></i> Add New Order
            </a>
            <button id="refresh-btn" class="btn btn-secondary btn-lg" onclick="refreshDashboard()">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
            <button id="export-btn" class="btn btn-success btn-lg" onclick="exportOrders()">
                <i class="fas fa-download"></i> Export Orders
            </button>
        </div>

        <!-- Filters and Search -->
        <div class="filter-container full-width animate__animated animate__slideUp" style="animation-delay: 0.4s">
            <div class="search-section">
                <input type="text" id="search" placeholder="Search orders..." class="search-input" />
            </div>
            <div class="filter-section">
                <select id="status-filter" class="filter-select">
                    <option value="">All Status</option>
                    <option value="Pending">Pending</option>
                    <option value="Shipped">Shipped</option>
                    <option value="Delivered">Delivered</option>
                </select>
                <input type="date" id="date-from" class="filter-input" />
                <input type="date" id="date-to" class="filter-input" />
                <button id="apply-filters" class="btn btn-outline-primary">Apply Filters</button>
            </div>
        </div>

        <!-- View Toggle -->
        <div class="view-toggle animate__animated animate__fadeIn" style="animation-delay: 0.5s">
            <button class="view-btn active" id="grid-view-btn">Grid View</button>
            <button class="view-btn" id="table-view-btn">Table View</button>
        </div>

        <!-- Loading Spinner -->
        <div id="loading-spinner" class="loading-spinner" style="display: none;">
            <div class="spinner"></div>
        </div>

        <!-- Data Display -->
        <div id="data-grid" class="grid-container full-width">
            @foreach (var order in Model.Orders)
            {
                    <div class="order-card" data-order-id="@order.OrderId">
                        <div class="order-header">
                            <h5>Order #@order.OrderNumber</h5>
                            <span class="status-badge status-@order.Status.ToLower()">@order.Status</span>
                        </div>
                        <div class="order-body">
                            <p><strong>Customer:</strong> @order.CustomerName</p>
                            <p><strong>Date:</strong> @order.OrderDate.ToString("MMM dd, yyyy")</p>
                            <p><strong>Amount:</strong> @order.Amount.ToString("C")</p>
                        </div>
                        <div class="order-actions">
                            <button class="btn btn-sm btn-primary" onclick="viewOrderDetails(@order.OrderId)">
                                View Details
                            </button>
                        </div>
                    </div>
            }
        </div>

        <div id="data-table" class="table-container full-width" style="display: none;">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Order #</th>
                        <th>Customer</th>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="orders-table-body">
                    @foreach (var order in Model.Orders)
                    {
                            <tr data-order-id="@order.OrderId">
                                <td>@order.OrderNumber</td>
                                <td>@order.CustomerName</td>
                                <td>@order.OrderDate.ToString("MMM dd, yyyy")</td>
                                <td>@order.Amount.ToString("C")</td>
                                <td><span class="status-badge status-@order.Status.ToLower()">@order.Status</span></td>
                                <td>
                                    <button class="btn btn-sm btn-primary" onclick="viewOrderDetails(@order.OrderId)">
                                        Details
                                    </button>
                                </td>
                            </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Analytics Chart -->
    <div class="chart-container full-width animate__animated animate__fadeIn" style="animation-delay: 0.6s">
        <h4>Orders Status Overview</h4>
        <canvas id="orders-chart"></canvas>
    </div>

    <!-- Footer -->
    <footer class="footer full-width animate__animated animate__fadeIn" style="animation-delay: 0.8s">
        <div class="footer-content full-width">
            <p>© 2025 - Order Management System - <a href="#">Privacy Policy</a></p>
        </div>
    </footer>

    <!-- Order Details Modal -->
    <div class="modal fade" id="orderModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Order Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="orderModalBody">
                    <!-- Order details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="~/js/dashboard.js"></script>
        <script src="~/js/shared.js"></script>
}

@section Styles {
        <link rel="stylesheet" href="~/css/dashboard.css" />
        <link rel="stylesheet" href="~/css/shared.css" />
}